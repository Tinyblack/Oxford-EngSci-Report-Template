%% Author: ZIMO ZHAO <zimo.zhao@eng.ox.ac.uk>
%% Soft Matter Photonics Group @ EngSci Oxford
\NeedsTeXFormat{LaTeX2e}%
\ProvidesPackage{OxReport}[2021/07/14 OxEngSci Report Template]%

%-----------------------------------------------%
% Necessary packages for the report             %
%-----------------------------------------------%

\RequirePackage{geometry}%
\RequirePackage{fontspec}%
\RequirePackage{graphicx}%
\RequirePackage{float}%
\RequirePackage{titletoc}%
\RequirePackage{titlesec}%
\RequirePackage{setspace}%
\RequirePackage{array}%
\RequirePackage{enumerate}%
\RequirePackage{enumitem}%
\RequirePackage{fancyhdr}%
\RequirePackage{amsmath}%
\RequirePackage{amssymb}%
\RequirePackage[hidelinks]{hyperref}%
\RequirePackage{caption}%
\RequirePackage{subcaption}%
\RequirePackage{color}%
\RequirePackage{supertabular}%
\RequirePackage[skip]{parskip}%
\RequirePackage{xparse}%
\RequirePackage{soul}%
\RequirePackage{calc}%
\RequirePackage[version=4]{mhchem}%
\RequirePackage{adjustbox}%
\RequirePackage[style=ieee,citestyle=numeric-comp]{biblatex}
\RequirePackage{microtype}%

%-----------------------------------------------%
% Start of package marcos                       %
%-----------------------------------------------%

\ProcessOptions%

%-----------------------------------------------%
% Layout Control for the report                 %
%-----------------------------------------------%

% Page margins configuration
\geometry{left=2cm, top=2cm, right=2cm, bottom=2cm}%

%-----------------------------------------------%
% Captions setup                                %
%-----------------------------------------------%

% Caption margins to the context
\captionsetup{margin={5pt,5pt}}%
% Caption fontsize
\captionsetup{font={small}}%
% Caption label font
\captionsetup{labelfont={bf}}%
% Subcaption fontsize
\captionsetup[sub]{font={small}}

%-----------------------------------------------%
% Equations breakup                             %
%-----------------------------------------------%

% Allow equation breakup over the pages
\allowdisplaybreaks%

%-----------------------------------------------%
% Tabular setup                                 %
%-----------------------------------------------%

% Set array rule width
\setlength{\arrayrulewidth}{0.5mm}%
% Set arry rule width
\setlength{\tabcolsep}{12pt}%
% Set arry line stretch
\renewcommand{\arraystretch}{1.5}%

%-----------------------------------------------%
% Page header/footer setup (default: OFF)       %
%-----------------------------------------------%

%\pagestyle{fancy}
%\lhead{header-left}
%\chead{header-centre}
%\rhead{header-right}
%\lfoot{foot-left}
%\cfoot{foot-centre}
%\rfoot{foot-right}

%-----------------------------------------------%
% Special font for the report title page        %
%-----------------------------------------------%

% Garamond font with wider letter space
\newfontfamily\Garamondfontwide{Garamond}[LetterSpace=30.00]%
% Garamond font with normal letter space
\newfontfamily\Garamondfontnormal{Garamond}%

%-----------------------------------------------%
%           Title Page Content Control          %
%-----------------------------------------------%

% Horizental rule in title page
\newcommand{\titleHRule}{\rule{\linewidth}{0.5pt}\par}%
% University name in title page
\newcommand{\titleUniversity}[1]{{\Garamondfontwide\large\rule[4.5pt]{2pt}{2pt}\hspace{0.5em}#1\hspace{0.5em}\rule[4.5pt]{2pt}{2pt}\par}}%
% Department name in title page
\newcommand{\titleDepartment}[1]{{\Garamondfontwide\large\rule[4.5pt]{2pt}{2pt}\hspace{0.5em}#1\hspace{0.5em}\rule[4.5pt]{2pt}{2pt}\par}}%
% Thesis/Report title in title page
\newcommand{\titleTitle}[1]{{\Garamondfontnormal\fontsize{26pt}{20pt}\selectfont\bfseries #1\par}}%
% Document Type in title page
\newcommand{\titleType}[1]{{\Garamondfontnormal\large\rule[4.5pt]{2pt}{2pt}\hspace{0.5em}#1\hspace{0.5em}\rule[4.5pt]{2pt}{2pt}\par}}%
% Author name in title page
\newcommand{\titleName}[1]{{\Garamondfontnormal\fontsize{22pt}{10pt}\selectfont\bfseries #1\par}}%
% College name in title page
\newcommand{\titleCollege}[1]{{\Garamondfontnormal\fontsize{16pt}{10pt}\selectfont #1\par}}%
% Supervisor group information in title page
\newcommand{\titleSupervisor}[1]{{\Garamondfontnormal\fontsize{14pt}{20pt}\selectfont #1\par}}%
% Date information in title page
\newcommand{\titleDate}[1]{{\Garamondfontwide\fontsize{14pt}{20pt}\selectfont #1\par}}%

%-----------------------------------------------%
% Setup an environment for roman page numbers   %
%-----------------------------------------------%

\newenvironment{romanpages}
{\cleardoublepage\setcounter{page}{1}\renewcommand{\thepage}{\roman{page}}}
{\cleardoublepage\renewcommand{\thepage}{\arabic{page}}\setcounter{page}{1}}

%-----------------------------------------------%
% Change the appearance of Chapter Title        %
%-----------------------------------------------%

% Change the spacing of the Chapter title
\titlespacing*{\chapter}{0pt}{-20pt}{30pt}

% Change the format of the Chapter title
\titleformat{\chapter}[display]
{\bfseries\Large}
{\filleft\MakeUppercase{\chaptertitlename} \Huge\thechapter}
{4ex}
{\titlerule\vspace{0.6ex}\filright}%
[\vspace{1.5ex}\titlerule]%

%-----------------------------------------------%
% Change the appearance of Section Title        %
%-----------------------------------------------%

% Change the format of the Section title
\titleformat{\section}{\fontsize{14pt}{12pt}\selectfont\bfseries}{\thesection}{1em}{}%

% Change the format of the subSection title
\titleformat{\subsection}{\fontsize{13pt}{12pt}\selectfont\bfseries}{\thesubsection}{1em}{}%

% Change the format of the subsubSection title
\titleformat{\subsubsection}{\fontsize{12pt}{12pt}\selectfont\bfseries}{\thesubsubsection}{1em}{}%

%-----------------------------------------------%
% Change the appearance of ToC Entries          %
%-----------------------------------------------%

% Change the appearance of chapter entries
\titlecontents{chapter}
[3pc]
{\addvspace{1.5pc}\filcenter}
{\normalsize\bfseries CHAPTER \thecontentslabel:\enspace}
{\huge}
{} % That is, without page number
[\addvspace{.5pc}]

% Change the appearance of chapter entries
\titlecontents{section}
[2.3em] % ie, 1.5em (chapter) + 2.3em
{}
{\contentslabel{2.3em}}
{\hspace*{-2.3em}}
{\titlerule*[1pc]{.}\contentspage}

% Change the appearance of chapter entries
\titlecontents{subsection}
[4.6em] % ie, 1.5em (chapter) + 2.3em
{}
{\contentslabel{2.3em}}
{\hspace*{-2.3em}}
{\titlerule*[1pc]{.}\contentspage}

% Change the appearance of chapter entries
\titlecontents{subsubsection}
[6.9em] % ie, 1.5em (chapter) + 2.3em
{}
{\contentslabel{2.3em}}
{\hspace*{-2.3em}}
{\titlerule*[1pc]{.}\contentspage}

%-----------------------------------------------%
% Change the section names                      %
%-----------------------------------------------%

\renewcommand\contentsname{Contents}
\renewcommand\listfigurename{List of Figures}
\renewcommand\listtablename{List of Tables}
\renewcommand\bibname{\bfseries Reference}
\renewcommand\indexname{Index}
\renewcommand\figurename{Figure}
\renewcommand\tablename{Table}
\renewcommand\partname{Part}
\renewcommand\chaptername{Chapter}
\renewcommand\appendixname{Appendix}
\renewcommand\abstractname{Abstract}
%\renewcommand{\equationname}{Equation}

%\renewcommand\thesubsubsection{\thesubsection.(\alph{subsubsection})}
\renewcommand\thesubsubsection{(\roman{subsubsection})}

%-----------------------------------------------%
% Change the cross reference names              %
%-----------------------------------------------%
\renewcommand{\sectionautorefname}{Section}
\renewcommand{\subsectionautorefname}{Section}
\renewcommand{\subsubsectionautorefname}{Section}
\renewcommand{\chapterautorefname}{Chapter}

%-----------------------------------------------%
% End of package marcos                         %
%-----------------------------------------------%

\endinput